<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coding Profiles - Portfolio Admin</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <div class="admin-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">Portfolio CMS</div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Overview</div>
                    <a href="dashboard.html" class="nav-link">
                        <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                        </svg>
                        Dashboard
                    </a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Content</div>
                    <a href="home.html" class="nav-link">
                        <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                        </svg>
                        Home
                    </a>
                    <a href="about.html" class="nav-link">
                        <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        About
                    </a>
                    <a href="skills.html" class="nav-link">
                        <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Skills
                    </a>
                    <a href="projects.html" class="nav-link">
                        <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                        </svg>
                        Projects
                    </a>
                    <a href="coding-profiles.html" class="nav-link active">
                        <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
                        </svg>
                        Coding Profiles
                    </a>
                    <a href="experience.html" class="nav-link">
                        <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                        Experience
                    </a>
                    <a href="contact.html" class="nav-link">
                        <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                        Contact
                    </a>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">A</div>
                    <div><div class="user-name" id="userName">Admin</div></div>
                </div>
                <button class="btn-logout" onclick="logout()">Sign Out</button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1 class="page-title">Coding Profiles</h1>
                    <p class="page-subtitle">Manage your coding platform profiles and links</p>
                </div>
                <a href="../coding-profiles.html" target="_blank" class="btn-view-website">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                    </svg>
                    View Website
                </a>
            </div>

            <div id="successMessage" class="success-message">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                Changes saved successfully!
            </div>

            <div style="display: grid; grid-template-columns: 1fr 400px; gap: 24px;">
                <!-- Edit Form -->
                <div>
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Platform Links</h2>
                            <p class="card-description">Update your coding platform profiles</p>
                        </div>
                        
                        <form id="profilesForm">
                            <div class="form-group">
                                <label class="form-label">
                                    <svg width="20" height="20" style="vertical-align: middle; margin-right: 8px;" fill="#0077B5" viewBox="0 0 24 24">
                                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                    </svg>
                                    LinkedIn
                                </label>
                                <input type="url" id="linkedin" class="form-input" placeholder="https://linkedin.com/in/yourprofile">
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <svg width="20" height="20" style="vertical-align: middle; margin-right: 8px;" fill="#181717" viewBox="0 0 24 24">
                                        <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
                                    </svg>
                                    GitHub
                                </label>
                                <input type="url" id="github" class="form-input" placeholder="https://github.com/yourusername">
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <svg width="20" height="20" style="vertical-align: middle; margin-right: 8px;" fill="#FFA116" viewBox="0 0 24 24">
                                        <path d="M13.483 0a1.374 1.374 0 0 0-.961.438L7.116 6.226l-3.854 4.126a5.266 5.266 0 0 0-1.209 2.104 5.35 5.35 0 0 0-.125.513 5.527 5.527 0 0 0 .062 2.362 5.83 5.83 0 0 0 .349 1.017 5.938 5.938 0 0 0 1.271 1.818l4.277 4.193.039.038c2.248 2.165 5.852 2.133 8.063-.074l2.396-2.392c.54-.54.54-1.414.003-1.955a1.378 1.378 0 0 0-1.951-.003l-2.396 2.392a3.021 3.021 0 0 1-4.205.038l-.02-.019-4.276-4.193c-.652-.64-.972-1.469-.948-2.263a2.68 2.68 0 0 1 .066-.523 2.545 2.545 0 0 1 .619-1.164L9.13 8.114c1.058-1.134 3.204-1.27 4.43-.278l3.501 2.831c.593.48 1.461.387 1.94-.207a1.384 1.384 0 0 0-.207-1.943l-3.5-2.831c-.8-.647-1.766-1.045-2.774-1.202l2.015-2.158A1.384 1.384 0 0 0 13.483 0zm-2.866 12.815a1.38 1.38 0 0 0-1.38 1.382 1.38 1.38 0 0 0 1.38 1.382H20.79a1.38 1.38 0 0 0 1.38-1.382 1.38 1.38 0 0 0-1.38-1.382z"/>
                                    </svg>
                                    LeetCode
                                </label>
                                <input type="url" id="leetcode" class="form-input" placeholder="https://leetcode.com/yourusername">
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    <svg width="20" height="20" style="vertical-align: middle; margin-right: 8px;" fill="#00EA64" viewBox="0 0 24 24">
                                        <path d="M0 0v24h24V0zm9.95 8.002h1.805c.061 0 .111.05.111.111v7.767c0 .061-.05.111-.111.111H9.95c-.061 0-.111-.05-.111-.111v-7.767c0-.061.05-.111.111-.111zm-3.481.002h1.805c.061 0 .111.05.111.111v7.767c0 .061-.05.111-.111.111H6.469c-.061 0-.111-.05-.111-.111v-7.767c0-.061.05-.111.111-.111zm6.963 0h1.805c.061 0 .111.05.111.111v7.767c0 .061-.05.111-.111.111h-1.805c-.061 0-.111-.05-.111-.111v-7.767c0-.061.05-.111.111-.111z"/>
                                    </svg>
                                    HackerRank
                                </label>
                                <input type="url" id="hackerrank" class="form-input" placeholder="https://hackerrank.com/yourusername">
                            </div>

                            <button type="submit" class="btn btn-primary">
                                <svg width="20" height="20" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M7.707 10.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V6h5a2 2 0 012 2v7a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2h5v5.586l-1.293-1.293zM9 4a1 1 0 012 0v2H9V4z"/>
                                </svg>
                                Save Changes
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Live Preview -->
                <div>
                    <div class="preview-panel">
                        <div class="preview-header">LIVE PREVIEW</div>
                        <div class="preview-device">
                            <div style="padding: 20px; font-size: 12px;">
                                <div style="font-weight: 700; margin-bottom: 16px;">Coding Profiles</div>
                                <div id="previewProfiles">
                                    <div style="margin-bottom: 12px; padding: 12px; background: #f5f5f7; border-radius: 8px;">
                                        <div style="font-weight: 600; margin-bottom: 4px;">LinkedIn</div>
                                        <div style="color: #0071e3; font-size: 10px; word-break: break-all;" id="previewLinkedIn">Not set</div>
                                    </div>
                                    <div style="margin-bottom: 12px; padding: 12px; background: #f5f5f7; border-radius: 8px;">
                                        <div style="font-weight: 600; margin-bottom: 4px;">GitHub</div>
                                        <div style="color: #0071e3; font-size: 10px; word-break: break-all;" id="previewGitHub">Not set</div>
                                    </div>
                                    <div style="margin-bottom: 12px; padding: 12px; background: #f5f5f7; border-radius: 8px;">
                                        <div style="font-weight: 600; margin-bottom: 4px;">LeetCode</div>
                                        <div style="color: #0071e3; font-size: 10px; word-break: break-all;" id="previewLeetCode">Not set</div>
                                    </div>
                                    <div style="padding: 12px; background: #f5f5f7; border-radius: 8px;">
                                        <div style="font-weight: 600; margin-bottom: 4px;">HackerRank</div>
                                        <div style="color: #0071e3; font-size: 10px; word-break: break-all;" id="previewHackerRank">Not set</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const token = localStorage.getItem('adminToken');
        if (!token) window.location.href = 'login.html';
        
        const email = localStorage.getItem('adminEmail') || 'admin@example.com';
        document.getElementById('userName').textContent = email.split('@')[0];
        document.getElementById('userAvatar').textContent = email[0].toUpperCase();
        
        function logout() {
            localStorage.removeItem('adminToken');
            localStorage.removeItem('adminEmail');
            window.location.href = 'login.html';
        }

        // Load data
        fetch('/api/admin/profile', {
            headers: { 'Authorization': 'Bearer ' + token }
        })
        .then(r => r.json())
        .then(data => {
            if (data.success) {
                const p = data.data;
                document.getElementById('linkedin').value = p.socialLinks?.linkedin || '';
                document.getElementById('github').value = p.socialLinks?.github || '';
                document.getElementById('leetcode').value = p.socialLinks?.leetcode || '';
                document.getElementById('hackerrank').value = p.socialLinks?.hackerrank || '';
                updatePreview();
            }
        });

        // Live preview update
        function updatePreview() {
            document.getElementById('previewLinkedIn').textContent = document.getElementById('linkedin').value || 'Not set';
            document.getElementById('previewGitHub').textContent = document.getElementById('github').value || 'Not set';
            document.getElementById('previewLeetCode').textContent = document.getElementById('leetcode').value || 'Not set';
            document.getElementById('previewHackerRank').textContent = document.getElementById('hackerrank').value || 'Not set';
        }

        document.querySelectorAll('.form-input').forEach(input => {
            input.addEventListener('input', updatePreview);
        });

        // Save data
        document.getElementById('profilesForm').onsubmit = async (e) => {
            e.preventDefault();
            
            const response = await fetch('/api/admin/profile', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + token
                },
                body: JSON.stringify({
                    socialLinks: {
                        linkedin: document.getElementById('linkedin').value,
                        github: document.getElementById('github').value,
                        leetcode: document.getElementById('leetcode').value,
                        hackerrank: document.getElementById('hackerrank').value
                    }
                })
            });
            
            const data = await response.json();
            if (data.success) {
                document.getElementById('successMessage').classList.add('show');
                setTimeout(() => {
                    document.getElementById('successMessage').classList.remove('show');
                }, 3000);
            }
        };
    </script>
</body>
</html>
